<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureGen - Password & Passphrase Tool</title>
	<link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        obsidian: {
                            bg: '#1e1e1e',       // Main background
                            pane: '#252526',     // Headers/Panels
                            border: '#3c3c3c',   // Borders
                            accent: '#7c3aed',   // Violet Primary
                            accentHover: '#6d28d9',
                            text: '#cccccc',     // Standard Text
                            textMuted: '#9ca3af',
                            success: '#10b981',
                            warning: '#f59e0b',
                            danger: '#ef4444'
                        }
                    },
                    fontFamily: {
                        mono: ['"Fira Code"', 'Consolas', 'Monaco', 'monospace'],
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Inter:wght@400;500;600&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        /* Webkit Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #1e1e1e; 
        }
        ::-webkit-scrollbar-thumb {
            background: #3c3c3c; 
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555; 
        }

        /* Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #7c3aed;
            cursor: pointer;
            margin-top: -6px; 
            box-shadow: 0 0 0 2px #252526;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #3c3c3c;
            border-radius: 2px;
        }
        input[type=range]:focus {
            outline: none;
        }

        /* Custom Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #7c3aed;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #7c3aed;
        }
        
        .tab-active {
            border-bottom: 2px solid #7c3aed;
            color: #fff;
        }
        .tab-inactive {
            border-bottom: 2px solid transparent;
            color: #9ca3af;
        }
    </style>
</head>
<body class="bg-obsidian-bg text-obsidian-text flex flex-col h-screen overflow-hidden">

    <header class="h-14 bg-obsidian-pane border-b border-obsidian-border flex items-center justify-between px-6 shrink-0 z-20">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded bg-obsidian-accent/20 flex items-center justify-center text-obsidian-accent">
                <i class="fa-solid fa-shield-halved"></i>
            </div>
            <h1 class="font-semibold text-lg tracking-tight text-white">SecureGen</h1>
        </div>
        <div class="flex gap-4 text-xs font-mono text-obsidian-textMuted">
            <span><i class="fa-solid fa-lock mr-1"></i>Client-side only</span>
        </div>
    </header>

    <main class="flex-1 flex flex-col items-center justify-start p-4 md:p-8 overflow-y-auto">
        
        <div class="w-full max-w-3xl flex flex-col gap-6">

            <div class="flex border-b border-obsidian-border w-full">
                <button id="tab-password" class="tab-active flex-1 pb-3 font-medium hover:text-white transition-colors" onclick="switchTab('password')">
                    <i class="fa-solid fa-asterisk mr-2"></i>Random String
                </button>
                <button id="tab-passphrase" class="tab-inactive flex-1 pb-3 font-medium hover:text-white transition-colors" onclick="switchTab('passphrase')">
                    <i class="fa-solid fa-horse-head mr-2"></i>Diceware Passphrase
                </button>
            </div>

            <div class="bg-obsidian-pane border border-obsidian-border rounded-lg p-6 relative group transition-all duration-300 hover:border-obsidian-accent/50">
                <label class="text-xs uppercase tracking-wider font-bold text-obsidian-textMuted mb-2 block">Generated Secret</label>
                
                <div class="relative">
                    <textarea id="output-display" readonly 
                        class="w-full bg-[#111827] text-white font-mono text-xl md:text-2xl p-4 rounded border border-obsidian-border focus:outline-none focus:border-obsidian-accent resize-none h-24 leading-relaxed break-all selection:bg-obsidian-accent selection:text-white"
                        spellcheck="false"></textarea>
                    
                    <button onclick="copyToClipboard()" class="absolute top-2 right-2 p-2 rounded text-obsidian-textMuted hover:text-white hover:bg-white/10 transition-all" title="Copy to Clipboard">
                        <i class="fa-regular fa-copy" id="copy-icon"></i>
                    </button>
                </div>

                <div class="mt-4 flex items-center gap-3">
                    <div class="flex-1 h-1.5 bg-obsidian-bg rounded-full overflow-hidden">
                        <div id="strength-bar" class="h-full w-0 transition-all duration-500 rounded-full"></div>
                    </div>
                    <span id="strength-text" class="text-xs font-mono w-20 text-right text-obsidian-textMuted">Empty</span>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                
                <div class="md:col-span-2 bg-obsidian-pane border border-obsidian-border rounded-lg p-6">
                    
                    <div id="controls-password" class="flex flex-col gap-6">
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-sm font-medium">Length</label>
                                <span id="len-val" class="font-mono text-obsidian-accent">16</span>
                            </div>
                            <input type="range" id="length-slider" min="4" max="64" value="16" oninput="updateSettings()">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <label class="flex items-center justify-between cursor-pointer group">
                                <span class="text-sm group-hover:text-white transition-colors"><i class="fa-solid fa-font mr-2 w-4 text-center"></i>Uppercase</span>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="chk-upper" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer" checked onchange="updateSettings()"/>
                                    <label for="chk-upper" class="toggle-label block overflow-hidden h-5 rounded-full bg-obsidian-border cursor-pointer"></label>
                                </div>
                            </label>

                            <label class="flex items-center justify-between cursor-pointer group">
                                <span class="text-sm group-hover:text-white transition-colors"><i class="fa-solid fa-hashtag mr-2 w-4 text-center"></i>Numbers</span>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="chk-numbers" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer" checked onchange="updateSettings()"/>
                                    <label for="chk-numbers" class="toggle-label block overflow-hidden h-5 rounded-full bg-obsidian-border cursor-pointer"></label>
                                </div>
                            </label>

                            <label class="flex items-center justify-between cursor-pointer group">
                                <span class="text-sm group-hover:text-white transition-colors"><i class="fa-solid fa-icons mr-2 w-4 text-center"></i>Symbols</span>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="chk-symbols" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer" checked onchange="updateSettings()"/>
                                    <label for="chk-symbols" class="toggle-label block overflow-hidden h-5 rounded-full bg-obsidian-border cursor-pointer"></label>
                                </div>
                            </label>
                             <label class="flex items-center justify-between cursor-pointer group">
                                <span class="text-sm group-hover:text-white transition-colors"><i class="fa-solid fa-code mr-2 w-4 text-center"></i>Ambiguous</span>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="chk-ambiguous" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer" onchange="updateSettings()"/>
                                    <label for="chk-ambiguous" class="toggle-label block overflow-hidden h-5 rounded-full bg-obsidian-border cursor-pointer"></label>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div id="controls-passphrase" class="hidden flex flex-col gap-6">
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-sm font-medium">Word Count</label>
                                <span id="word-count-val" class="font-mono text-obsidian-accent">4</span>
                            </div>
                            <input type="range" id="word-slider" min="3" max="10" value="4" oninput="updateSettings()">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <label class="flex items-center justify-between cursor-pointer group">
                                <span class="text-sm group-hover:text-white transition-colors">Capitalize</span>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="chk-capitalize" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer" checked onchange="updateSettings()"/>
                                    <label for="chk-capitalize" class="toggle-label block overflow-hidden h-5 rounded-full bg-obsidian-border cursor-pointer"></label>
                                </div>
                            </label>

                            <label class="flex items-center justify-between cursor-pointer group">
                                <span class="text-sm group-hover:text-white transition-colors">Add Number</span>
                                <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                    <input type="checkbox" id="chk-addnum" class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer" onchange="updateSettings()"/>
                                    <label for="chk-addnum" class="toggle-label block overflow-hidden h-5 rounded-full bg-obsidian-border cursor-pointer"></label>
                                </div>
                            </label>
                        </div>

                        <div>
                            <label class="text-sm font-medium block mb-2">Separator</label>
                            <div class="flex gap-2">
                                <button class="sep-btn flex-1 bg-obsidian-bg border border-obsidian-border hover:border-obsidian-accent py-2 rounded text-sm font-mono transition-colors active-sep" data-char="-" onclick="setSeparator(this)">-</button>
                                <button class="sep-btn flex-1 bg-obsidian-bg border border-obsidian-border hover:border-obsidian-accent py-2 rounded text-sm font-mono transition-colors" data-char="." onclick="setSeparator(this)">.</button>
                                <button class="sep-btn flex-1 bg-obsidian-bg border border-obsidian-border hover:border-obsidian-accent py-2 rounded text-sm font-mono transition-colors" data-char="_" onclick="setSeparator(this)">_</button>
                                <button class="sep-btn flex-1 bg-obsidian-bg border border-obsidian-border hover:border-obsidian-accent py-2 rounded text-sm font-mono transition-colors" data-char=" " onclick="setSeparator(this)">Space</button>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="flex flex-col gap-4">
                    <button onclick="generate()" class="bg-obsidian-accent hover:bg-obsidian-accentHover text-white font-semibold py-4 rounded-lg shadow-lg shadow-purple-900/20 transition-all transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2">
                        <i class="fa-solid fa-arrows-rotate"></i> Generate
                    </button>

                    <div class="bg-obsidian-pane border border-obsidian-border rounded-lg p-4 flex-1">
                        <h3 class="text-sm font-medium mb-3 text-obsidian-textMuted">History</h3>
                        <ul id="history-list" class="flex flex-col gap-2 overflow-y-auto max-h-[200px] text-xs font-mono pr-1 custom-scrollbar">
                            <li class="text-center text-gray-600 italic py-2">No history yet</li>
                        </ul>
                        <div class="text-right mt-2">
                            <button onclick="clearHistory()" class="text-xs text-obsidian-textMuted hover:text-red-400 transition-colors">Clear</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </main>

    <footer class="bg-obsidian-pane border-t border-obsidian-border py-3 text-center shrink-0 z-10 flex flex-col md:flex-row justify-center items-center gap-3">

    <a href="https://homelabplayground.com" class="text-gray-500 hover:text-violet-400 text-xs transition-colors font-sans no-underline">

        HomeLab Playground

    </a>



    <span class="hidden md:block text-obsidian-border mx-1">|</span>



    <a href="https://www.buymeacoffee.com/bryjogar" target="_blank" class="inline-flex items-center px-3 py-1 bg-obsidian-accent hover:bg-violet-600 text-white text-xs font-sans rounded-full transition-colors no-underline">

        <i class="fa-solid fa-mug-hot mr-1.5"></i>

        <span>Support The Tools</span>

    </a>

</footer>

    <script>
        // --- State ---
        let currentMode = 'password'; // 'password' or 'passphrase'
        let separator = '-';
        let history = [];

        // --- Data Lists ---
        const chars = {
            lower: 'abcdefghijklmnopqrstuvwxyz',
            upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            number: '0123456789',
            symbol: '!@#$%^&*()_+~`|}{[]:;?><,./-=',
            ambiguous: 'Il1O0'
        };

        // Compact Word List (~500 common words for Diceware simulation)
        const wordList = [
            "ability", "able", "aboard", "about", "above", "accept", "accident", "accord", "account", "action", "active", "actual", "admit", "adult", "affect", "afraid", "after", "again", "against", "agency", "agent", "ago", "agree", "ahead", "allow", "alone", "along", "alter", "among", "amount", "ancient", "anger", "angle", "angry", "animal", "answer", "appear", "apple", "apply", "area", "argue", "arm", "army", "around", "arrive", "art", "aside", "ask", "aspect", "atom", "attack", "attend", "author", "auto", "autumn", "avail", "avoid", "awake", "award", "aware", "away", "baby", "back", "bad", "bag", "bake", "ball", "bank", "bar", "base", "basic", "basis", "basket", "bat", "battle", "beach", "bear", "beat", "beauty", "become", "bed", "beer", "before", "begin", "behind", "being", "belief", "bell", "belong", "below", "belt", "bench", "bend", "best", "better", "beyond", "big", "bike", "bill", "bind", "bird", "birth", "bit", "bite", "black", "blade", "blame", "blank", "blast", "blend", "bless", "blind", "block", "blood", "blow", "blue", "board", "boat", "body", "boil", "bold", "bolt", "bomb", "bond", "bone", "book", "boom", "boot", "border", "born", "boss", "both", "bottle", "bottom", "bounce", "bowl", "box", "boy", "brain", "brake", "branch", "brave", "bread", "break", "breath", "brick", "bridge", "brief", "bright", "bring", "broad", "broken", "brother", "brown", "brush", "bucket", "build", "bulb", "bulk", "bullet", "bunch", "burn", "burst", "bury", "bus", "bush", "busy", "but", "button", "buy", "buyer", "cabin", "cable", "cage", "cake", "call", "calm", "camera", "camp", "can", "cancel", "candy", "cannon", "canvas", "cap", "cape", "card", "care", "career", "carpet", "carry", "cart", "case", "cash", "cast", "cat", "catch", "cause", "cave", "cell", "cent", "center", "chain", "chair", "chalk", "chance", "change", "chant", "chaos", "charge", "chart", "chase", "cheap", "check", "cheek", "cheer", "cheese", "chef", "chest", "chicken", "chief", "child", "chill", "chip", "choice", "choose", "chunk", "church", "cigar", "cinema", "circle", "city", "claim", "clap", "class", "clean", "clear", "clerk", "clever", "click", "client", "cliff", "climb", "clip", "clock", "close", "cloth", "cloud", "club", "clue", "coach", "coal", "coast", "coat", "code", "coffee", "coin", "cold", "collar", "color", "comb", "come", "comfort", "comic", "common", "company", "concert", "cook", "cool", "copper", "copy", "cord", "core", "corn", "corner", "cost", "couch", "count", "county", "couple", "course", "court", "cover", "cow", "crack", "craft", "crash", "crazy", "cream", "create", "credit", "creek", "crew", "crisis", "cross", "crowd", "crown", "cruel", "crush", "cry", "cube", "cup", "cure", "curl", "curry", "curve", "custom", "cut", "cycle", "dad", "daily", "damage", "dance", "danger", "dare", "dark", "data", "date", "dawn", "day", "dead", "deal", "dear", "death", "debate", "debt", "decade", "decay", "deck", "deep", "deer", "defeat", "defend", "define", "degree", "delay", "deliver", "demand", "demo", "denial", "deny", "depend", "depth", "deputy", "desert", "design", "desk", "detail", "detect", "device", "devil", "dial", "diet", "differ", "dig", "dinner", "direct", "dirt", "dish", "disk", "disty", "diver", "divide", "doctor", "dog", "doll", "dome", "done", "donor", "doom", "door", "dot", "double", "doubt", "down", "draft", "drag", "drain", "drama", "draw", "dream", "dress", "drift", "drill", "drink", "drive", "drop", "drum", "dry", "duck", "due", "dull", "dump", "dust", "duty", "eagle", "ear", "early", "earn", "earth", "ease", "east", "easy", "eat", "echo", "edge", "edit", "effect", "egg", "eight", "either", "elbow", "elder", "elect", "elite", "else", "empty", "end", "energy", "engine", "enjoy", "enough", "enter", "entry", "envy", "equal", "equip", "erase", "error", "escape", "essay", "even", "event", "ever", "every", "evil", "exact", "exam", "exit", "expand", "expect", "extra", "eye", "face", "fact", "fade", "fail", "fair", "faith", "fall", "false", "fame", "family", "fan", "fancy", "far", "farm", "fast", "fat", "fate", "fault", "fear", "feast", "feed", "feel", "fence", "fetch", "fever", "few", "fiber", "field", "fight", "figure", "file", "fill", "film", "filter", "final", "find", "fine", "finger", "finish", "fire", "firm", "first", "fish", "fist", "fit", "five", "fix", "flag", "flame", "flash", "flat", "flavor", "flee", "fleet", "flesh", "flex", "flight", "float", "flock", "floor", "flow", "flower", "fluid", "fly", "foam", "focus", "fog", "fold", "folk", "follow", "food", "foot", "force", "forest", "forget", "fork", "form", "fort", "forum", "fossil", "found", "four", "fox", "frame", "free", "freeze", "fresh", "friend", "frog", "front", "frost", "frown", "frozen", "fruit", "fuel", "full", "fun", "fund", "funny", "fur", "future", "gain", "galaxy", "gallery", "game", "gap", "garage", "garden", "garlic", "gas", "gate", "gather", "gauge", "gaze", "gear", "gender", "gene", "general", "genius", "genre", "gentle", "ghost", "giant", "gift", "giggle", "ginger", "girl", "give", "glad", "glance", "glare", "glass", "glide", "global", "glove", "glow", "glue", "goal", "goat", "gold", "golf", "good", "goose", "gospel", "govern", "gown", "grab", "grace", "grade", "grain", "grand", "grant", "grape", "graph", "grasp", "grass", "gravity", "gray", "great", "green", "grid", "grief", "grill", "grin", "grip", "grit", "gross", "group", "grow", "guard", "guess", "guest", "guide", "guild", "guilt", "habit", "hair", "half", "hall", "halt", "hand", "handle", "hang", "happen", "happy", "harbor", "hard", "harm", "hat", "hate", "hawk", "hazard", "head", "health", "heap", "hear", "heart", "heat", "heavy", "hedge", "heel", "height", "hello", "helmet", "help", "hen", "hero", "hidden", "high", "hill", "hint", "hip", "hire", "history", "hobby", "hockey", "hold", "hole", "home", "honey", "hood", "hope", "horn", "horror", "horse", "host", "hot", "hotel", "hour", "house", "hover", "how", "hub", "huge", "human", "humble", "humor", "hunt", "hurry", "hurt", "husband", "hybrid", "ice", "icon", "idea", "ignore", "ill", "image", "impact", "inch", "income", "index", "indoor", "infant", "inject", "injury", "inner", "input", "insect", "inside", "inspire", "install", "intact", "invest", "invite", "iron", "island", "issue", "item", "jacket", "jaguar", "jail", "jar", "jazz", "jealous", "jeans", "jelly", "jewel", "job", "join", "joke", "joy", "judge", "juice", "jump", "jungle", "junior", "junk", "just", "kangaroo", "keen", "keep", "ketchup", "key", "kick", "kid", "kidney", "kind", "kingdom", "kiss", "kit", "kite", "kitten", "kiwi", "knee", "knife", "knock", "know", "lab", "label", "labor", "ladder", "lady", "lake", "lamp", "land", "lane", "large", "laser", "last", "late", "laugh", "launch", "law", "lawn", "lawyer", "lay", "layer", "lazy", "lead", "leader", "leaf", "learn", "leave", "lecture", "left", "leg", "legal", "legend", "lemon", "length", "lens", "leopard", "lesson", "letter", "level", "liar", "liberty", "library", "license", "life", "lift", "light", "like", "limb", "limit", "line", "link", "lion", "liquid", "list", "listen", "little", "live", "load", "loan", "lobby", "local", "lock", "logic", "lonely", "long", "loop", "loose", "lord", "lose", "lot", "loud", "love", "low", "loyal", "luck", "luggage", "lumber", "lunar", "lunch", "luxury", "lyrics", "machine", "mad", "magic", "magnet", "maid", "mail", "main", "major", "make", "mammal", "man", "manage", "mandate", "mango", "mansion", "manual", "maple", "marble", "march", "margin", "marine", "market", "marriage", "mask", "mass", "master", "match", "mate", "matrix", "matter", "maximum", "maze", "meadow", "mean", "measure", "meat", "mechanic", "medal", "media", "melody", "melt", "member", "memory", "mention", "menu", "mercy", "merge", "merit", "merry", "mesh", "message", "metal", "method", "middle", "might", "milk", "million", "mimic", "mind", "minimum", "minor", "minute", "miracle", "mirror", "misery", "miss", "mistake", "mix", "mixed", "mixture", "mobile", "model", "modify", "mom", "moment", "money", "monitor", "monkey", "monster", "month", "moon", "moral", "more", "morning", "mosquito", "mother", "motion", "motor", "mount", "mouse", "mouth", "move", "movie", "much", "muffin", "mule", "multiply", "muscle", "museum", "music", "must", "mutual", "myself", "mystery", "myth"
        ];

        // --- Core Functions ---

        function switchTab(mode) {
            currentMode = mode;
            
            // UI Toggle
            const tPass = document.getElementById('tab-password');
            const tPhrase = document.getElementById('tab-passphrase');
            const cPass = document.getElementById('controls-password');
            const cPhrase = document.getElementById('controls-passphrase');

            if (mode === 'password') {
                tPass.classList.replace('tab-inactive', 'tab-active');
                tPhrase.classList.replace('tab-active', 'tab-inactive');
                cPass.classList.remove('hidden');
                cPhrase.classList.add('hidden');
            } else {
                tPhrase.classList.replace('tab-inactive', 'tab-active');
                tPass.classList.replace('tab-active', 'tab-inactive');
                cPhrase.classList.remove('hidden');
                cPass.classList.add('hidden');
            }
            updateSettings();
        }

        function setSeparator(btn) {
            separator = btn.getAttribute('data-char');
            // Update UI classes
            document.querySelectorAll('.sep-btn').forEach(b => {
                b.classList.remove('active-sep', 'border-obsidian-accent', 'text-white');
                b.classList.add('border-obsidian-border', 'text-obsidian-text');
            });
            btn.classList.remove('border-obsidian-border', 'text-obsidian-text');
            btn.classList.add('border-obsidian-accent', 'text-white');
            updateSettings();
        }

        function updateSettings() {
            // Update labels
            document.getElementById('len-val').innerText = document.getElementById('length-slider').value;
            document.getElementById('word-count-val').innerText = document.getElementById('word-slider').value;
            
            // Auto generate on change
            generate();
        }

        function generate() {
            const output = currentMode === 'password' ? generatePassword() : generatePassphrase();
            document.getElementById('output-display').value = output;
            evaluateStrength(output);
            addToHistory(output);
        }

        function generatePassword() {
            const length = parseInt(document.getElementById('length-slider').value);
            const useUpper = document.getElementById('chk-upper').checked;
            const useNumbers = document.getElementById('chk-numbers').checked;
            const useSymbols = document.getElementById('chk-symbols').checked;
            const excludeAmbiguous = document.getElementById('chk-ambiguous').checked;

            let charPool = chars.lower;
            if (useUpper) charPool += chars.upper;
            if (useNumbers) charPool += chars.number;
            if (useSymbols) charPool += chars.symbol;

            if (excludeAmbiguous) {
                // Remove chars from pool that exist in ambiguous list
                const ambiguousArr = chars.ambiguous.split('');
                ambiguousArr.forEach(c => {
                    charPool = charPool.split(c).join('');
                });
            }

            let result = '';
            // Ensure at least one of each selected type is present (simple approach)
            // A more robust CSPRNG approach:
            const cryptoArr = new Uint32Array(length);
            window.crypto.getRandomValues(cryptoArr);

            for (let i = 0; i < length; i++) {
                result += charPool[cryptoArr[i] % charPool.length];
            }

            return result;
        }

        function generatePassphrase() {
            const count = parseInt(document.getElementById('word-slider').value);
            const capitalize = document.getElementById('chk-capitalize').checked;
            const addNum = document.getElementById('chk-addnum').checked;

            let words = [];
            const cryptoArr = new Uint32Array(count);
            window.crypto.getRandomValues(cryptoArr);

            for(let i=0; i<count; i++) {
                let word = wordList[cryptoArr[i] % wordList.length];
                if(capitalize) {
                    word = word.charAt(0).toUpperCase() + word.slice(1);
                }
                words.push(word);
            }

            // Join logic
            let result = words.join(separator);

            if(addNum) {
                const randNum = Math.floor(Math.random() * 100);
                result += separator + randNum;
            }

            return result;
        }

        function evaluateStrength(pw) {
            // Basic entropy approximation
            const len = pw.length;
            let poolSize = 0;
            
            if (currentMode === 'password') {
                if (/[a-z]/.test(pw)) poolSize += 26;
                if (/[A-Z]/.test(pw)) poolSize += 26;
                if (/[0-9]/.test(pw)) poolSize += 10;
                if (/[^a-zA-Z0-9]/.test(pw)) poolSize += 30;
            } else {
                // Passphrase entropy approximation
                // 1000 words ~ 10 bits per word
                const wordCount = parseInt(document.getElementById('word-slider').value);
                poolSize = Math.pow(wordList.length, wordCount); // Not used directly but conceptual
                // Adjust length score manually for passphrases
            }

            // Calculate bits of entropy
            const entropy = currentMode === 'password' 
                ? len * Math.log2(poolSize || 1)
                : parseInt(document.getElementById('word-slider').value) * Math.log2(wordList.length) + (document.getElementById('chk-addnum').checked ? 6 : 0);

            const bar = document.getElementById('strength-bar');
            const txt = document.getElementById('strength-text');

            let color, width, label;

            if (entropy < 40) {
                color = 'bg-obsidian-danger';
                width = '30%';
                label = 'Weak';
            } else if (entropy < 65) {
                color = 'bg-obsidian-warning';
                width = '60%';
                label = 'Fair';
            } else if (entropy < 90) {
                color = 'bg-obsidian-success';
                width = '85%';
                label = 'Strong';
            } else {
                color = 'bg-emerald-400';
                width = '100%';
                label = 'Excellent';
            }

            bar.className = `h-full transition-all duration-500 rounded-full ${color}`;
            bar.style.width = width;
            txt.innerText = label;
        }

        function copyToClipboard() {
            const textarea = document.getElementById('output-display');
            textarea.select();
            
            navigator.clipboard.writeText(textarea.value).then(() => {
                const icon = document.getElementById('copy-icon');
                icon.classList.remove('fa-copy', 'fa-regular');
                icon.classList.add('fa-check', 'fa-solid', 'text-obsidian-success');
                
                setTimeout(() => {
                    icon.classList.remove('fa-check', 'fa-solid', 'text-obsidian-success');
                    icon.classList.add('fa-copy', 'fa-regular');
                }, 2000);
            });
        }

        function addToHistory(pw) {
            // Prevent duplicates at top of list
            if (history.length > 0 && history[0] === pw) return;
            
            history.unshift(pw);
            if (history.length > 10) history.pop();
            renderHistory();
        }

        function renderHistory() {
            const list = document.getElementById('history-list');
            list.innerHTML = '';
            
            history.forEach(pw => {
                const li = document.createElement('li');
                li.className = 'flex justify-between items-center group bg-white/5 p-2 rounded hover:bg-white/10 transition-colors cursor-pointer';
                li.onclick = () => {
                    document.getElementById('output-display').value = pw;
                    evaluateStrength(pw);
                    copyToClipboard();
                };

                const truncated = pw.length > 30 ? pw.substring(0, 30) + '...' : pw;
                
                li.innerHTML = `
                    <span class="truncate text-obsidian-text group-hover:text-white">${truncated}</span>
                    <i class="fa-solid fa-arrow-up opacity-0 group-hover:opacity-100 text-xs text-obsidian-accent"></i>
                `;
                list.appendChild(li);
            });
        }

        function clearHistory() {
            history = [];
            document.getElementById('history-list').innerHTML = '<li class="text-center text-gray-600 italic py-2">No history yet</li>';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
           generate(); 
        });

    </script>
</body>
</html>